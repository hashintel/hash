# This file either runs with JetBrains' http requests or using httpYac (https://httpyac.github.io).

### Insert Text data type
POST http://127.0.0.1:3000/data-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "dataType",
    "$id": "https://blockprotocol.org/@blockprotocol/types/data-type/text/v/1",
    "title": "Text",
    "type": "string"
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
    client.global.set("text_data_type_uri", encodeURIComponent(response.body.inner["$id"]));
%}

### Get Text data type
GET http://127.0.0.1:3000/data-type/{{text_data_type_uri}}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Update Text data type
PUT http://127.0.0.1:3000/data-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "dataType",
    "$id": "https://blockprotocol.org/@blockprotocol/types/data-type/text/v/2",
    "title": "Text",
    "description": "An ordered sequence of characters",
    "type": "string"
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Insert Name property type
POST http://127.0.0.1:3000/property-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "propertyType",
    "$id": "https://blockprotocol.org/@alice/types/property-type/name/v/1",
    "title": "Name",
    "oneOf": [
      {
        "$ref": "https://blockprotocol.org/@blockprotocol/types/data-type/text/v/1"
      }
    ]
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
    client.global.set("person_property_type_uri", encodeURIComponent(response.body.inner["$id"]));
%}

### Get Name property type
GET http://127.0.0.1:3000/property-type/{{person_property_type_uri}}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Update Name property type
PUT http://127.0.0.1:3000/property-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "propertyType",
    "$id": "https://blockprotocol.org/@alice/types/property-type/name/v/2",
    "title": "Name",
    "oneOf": [
      {
        "$ref": "https://blockprotocol.org/@blockprotocol/types/data-type/text/v/2"
      }
    ]
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Insert FriendOf link type
POST http://127.0.0.1:3000/link-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "linkType",
    "$id": "https://blockprotocol.org/@alice/types/link-type/friend-of/v/1",
    "title": "Friend Of",
    "description": "Someone who has a shared bond of mutual affection",
    "relatedKeywords": []
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
    client.global.set("friend_of_link_type_uri", encodeURIComponent(response.body.inner["$id"]));
%}

### Get FriendOf link type
GET http://127.0.0.1:3000/link-type/{{friend_of_link_type_uri}}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Update FriendOf link type
PUT http://127.0.0.1:3000/link-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "linkType",
    "$id": "https://blockprotocol.org/@alice/types/link-type/friend-of/v/2",
    "title": "Friend Of",
    "description": "Someone who has a shared bond of mutual affection",
    "relatedKeywords": ["social"]
  }

}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}


### Insert Person entity type
POST http://127.0.0.1:3000/entity-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "entityType",
    "$id": "https://blockprotocol.org/@alice/types/entity-type/person/v/1",
    "type": "object",
    "title": "Person",
    "properties": {
      "https://blockprotocol.org/@alice/types/property-type/name": {
        "$ref": "https://blockprotocol.org/@alice/types/property-type/name/v/1"
      }
    }
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
    client.global.set("person_entity_type_uri", encodeURIComponent(response.body.inner["$id"]));
%}

### Get Person entity type
GET http://127.0.0.1:3000/entity-type/{{person_entity_type_uri}}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Update Person entity type
PUT http://127.0.0.1:3000/entity-type
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "schema": {
    "kind": "entityType",
    "$id": "https://blockprotocol.org/@alice/types/entity-type/person/v/2",
    "type": "object",
    "title": "Person",
    "properties": {
      "https://blockprotocol.org/@alice/types/property-type/name": {
        "$ref": "https://blockprotocol.org/@alice/types/property-type/name/v/2"
      }
    },
    "links": {
      "https://blockprotocol.org/@alice/types/link-type/friend-of/v/2": {
        "type": "array",
        "items": {
          "$ref": "https://blockprotocol.org/@alice/types/entity-type/person/v/2"
        },
        "ordered": false
      }
    }
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}


### Insert Person entity
POST http://127.0.0.1:3000/entity
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "entity": {
    "https://blockprotocol.org/@alice/types/property-type/name": "Alice"
  },
  "entity_type_uri": "https://blockprotocol.org/@alice/types/entity-type/person/v/1"
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
    client.global.set("person_entity_id", encodeURIComponent(response.body.entity_id));
%}

### Get Person entity
GET http://127.0.0.1:3000/entity/{{person_entity_id}}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}

### Update Person entity
PUT http://127.0.0.1:3000/entity
Content-Type: application/json
Accept: application/json

{
  "account_id": "00000000-0000-0000-0000-000000000000",
  "entity_id": "{{person_entity_id}}",
  "entity_type_uri": "https://blockprotocol.org/@alice/types/entity-type/person/v/1",
  "entity": {
    "https://blockprotocol.org/@alice/types/property-type/name": "Alice Allison"
  }
}

> {%
    client.test("status", function() {
        client.assert(response.status === 200, "Response status is not 200");
    });
%}
